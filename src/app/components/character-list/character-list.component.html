<ng-container *ngIf="characters; else empty">
  <app-filter-list
    [searchTerm]="searchTerm"
    (searchTermChange)="onSearchChange($event)"
    [selectedGender]="selectedGender"
    (genderChange)="selectGender($event)"
    [selectedSpecies]="selectedSpecies"
    (speciesChange)="selectSpecie($event)"
    [selectedStatus]="selectedStatus"
    (statusChange)="selectStatus($event)"
    (favoritesToggle)="loadFavoriteItems($event)"
    (resetFilters)="resetFilter()"
    [showFavorites]="showFavorites"
  />

  <ng-container *ngIf="filteredCharacters.length; else empty">
    <ng-container *ngIf="!loadingCharacters; else loading">
      <div class="container py-8 min-h-[calc(100dvh-4rem-5rem)]">
        <div
          class="flex flex-col md:flex-row text-center md:text-inherit items-center gap-4 justify-between mb-4"
        >
          <h2
            class="text-xl font-medium tracking-widest font-creepster"
            *ngIf="showFavorites"
          >
            ❤️ Your Favorite Characters
          </h2>
          <h2
            class="text-xl font-medium tracking-widest font-creepster"
            *ngIf="!showFavorites"
          >
            ❤️ Rick and Morty characters
          </h2>

          <div
            class="flex gap-1 items-center border bg-input/50 rounded-xl p-1"
          >
            <button
              class="!block btn btn-square w-10 h-10 min-w-10 px-2 border-none bg-transparent hover:bg-input rounded-lg"
              title="Grid"
              [ngClass]="{ '!bg-foreground !text-background': showGrid }"
              (click)="showGrid = true"
            >
              <div class="leading-none block w-full">📅</div>
            </button>
            <button
              class="!block btn btn-square w-10 h-10 min-w-10 px-2 border-none bg-transparent hover:bg-input rounded-lg"
              title="List"
              [ngClass]="{ '!bg-foreground !text-background': !showGrid }"
              (click)="showGrid = false"
            >
              <div class="leading-none block w-full">📄</div>
            </button>
          </div>
        </div>

        <div
          [ngClass]="
            showGrid
              ? 'sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5'
              : 'grid-cols-1 lg:grid-cols-2'
          "
          class="grid gap-4"
        >
          <ng-container *ngFor="let character of filteredCharacters">
            <app-card-character
              [character]="character"
              [showGrid]="showGrid"
            ></app-card-character>
          </ng-container>
        </div>

        <div class="flex justify-center mt-8" *ngIf="currentPage < totalPages">
          <button
            (click)="loadMore()"
            class="btn btn-white"
            [disabled]="loadingCharacters"
          >
            <ng-container *ngIf="loadingCharacters">
              <span class="text-lg">⏳</span> <span>Loading...</span>
            </ng-container>
            <ng-container *ngIf="!loadingCharacters">
              <span class="text-lg">🎉</span> <span>Load more</span>
            </ng-container>
          </button>
        </div>
      </div>
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #loading>
  <app-loading />
</ng-template>

<ng-template #empty>
  <div class="container text-center">
    <div
      class="p-10 min-h-[calc(100dvh-4rem-5rem)] flex gap-1 flex-col justify-center items-center"
    >
      <span class="text-2xl mb-2">😭💔</span>
      <h3 class="text-sm text-foreground" *ngIf="!showFavorites">
        Nothing was found!
      </h3>
      <h3 class="text-sm text-foreground" *ngIf="showFavorites">
        Looks like you don't have any favorites yet!
      </h3>
      <span class="text-xs text-muted-foreground" *ngIf="!showFavorites"
        >Please try searching again.</span
      >
      <span class="text-xs text-muted-foreground" *ngIf="showFavorites"
        >Go back to the home page and choose the best ones for you.
      </span>
      <button
        *ngIf="!showFavorites"
        class="btn btn-white w-auto px-4 text-sm mt-4"
        (click)="resetFilter()"
      >
        <span class="text-lg">↺</span>
        <span>Reset</span>
      </button>
      <button
        *ngIf="showFavorites"
        class="btn btn-white w-auto px-4 text-sm mt-4"
        (click)="resetFilter()"
      >
        <span class="text-lg">👈</span>
        <span>Back to list</span>
      </button>
    </div>
  </div>
</ng-template>
