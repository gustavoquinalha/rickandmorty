<div class="w-full flex flex-col" *ngIf="characters; else loading">
  <div
    id="filtro"
    class="border-b backdrop-blur-sm bg-background/95 z-40 sticky top-0 left-0 w-full py-4 flex items-center gap-4 h-20 overflow-x-auto overflow-y-hidden"
  >
    <div class="container flex items-center gap-2">
      <div class="relative w-full">
        <div class="absolute top-3 left-3 text-xl">🔎</div>
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchChange()"
          placeholder="Pesquisar por nome..."
          class="input w-full h-14 min-w-56 pl-12 bg-transparent"
        />
      </div>

      <div class="flex gap-1 items-center border bg-transparent rounded-xl p-1">
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="female"
          (click)="selectGender('female')"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedGender === 'female'
          }"
        >
          <div class="leading-none block w-full mb-1">♀️</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Female
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="male"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedGender === 'male'
          }"
          (click)="selectGender('male')"
        >
          <div class="leading-none block w-full mb-1">♂️</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Male
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="genderless "
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedGender === 'genderless'
          }"
          (click)="selectGender('genderless')"
        >
          <div class="leading-none block w-full mb-1">🌳</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Genderless
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="gender unknown"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedGender === 'unknown'
          }"
          (click)="selectGender('unknown')"
        >
          <div class="leading-none block w-full mb-1">❔</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Unknown
          </div>
        </button>
      </div>

      <div class="flex gap-1 items-center border bg-transparent rounded-xl p-1">
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="Human"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedSpecies === 'Human'
          }"
          (click)="selectSpecie('Human')"
        >
          <div class="leading-none block w-full mb-1">🧑</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Human
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="Alien"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedSpecies === 'Alien'
          }"
          (click)="selectSpecie('Alien')"
        >
          <div class="leading-none block w-full mb-1">👽</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Alien
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="Humanoid"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedSpecies === 'Humanoid'
          }"
          (click)="selectSpecie('Humanoid')"
        >
          <div class="leading-none block w-full mb-1">🐲</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Humanoid
          </div>
        </button>

        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="Poopybutthole"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedSpecies === 'Poopybutthole'
          }"
          (click)="selectSpecie('Poopybutthole')"
        >
          <div class="leading-none block w-full mb-1">🥒</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Poopybutthole
          </div>
        </button>
        <button
          class="!block btn btn-square w-12 h-12 min-w-12 truncate border-none bg-transparent rounded-lg"
          title="Mythological Creature"
          [ngClass]="{
            '!bg-input !text-foreground !border-foreground':
              selectedSpecies === 'Mythological Creature'
          }"
          (click)="selectSpecie('Mythological Creature')"
        >
          <div class="leading-none block w-full mb-1">🪄</div>
          <div class="text-xs font-thin leading-none truncate block w-full">
            Mythological Creature
          </div>
        </button>
      </div>
    </div>
  </div>

  <div class="container py-4">
    <div
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
    >
      <div
        *ngFor="let character of filteredCharacters"
        class="group relative border rounded-xl overflow-hidden bg-card hover:border-foreground/30 transition-all cursor-pointer"
      >
        <img
          [src]="character?.image"
          alt="{{ character?.name }}"
          class="w-full h-auto"
        />
        <div
          class="overflow-hidden absolute truncate p-4 left-0 bottom-0 w-full bg-gradient-to-t from-background from-0% via-background/50 via-70% hover:via-40% to-background/50 hover:to-background/0 to-100% transition-all h-full flex flex-col justify-end"
        >
          <h3 class="text-2xl font-bold truncate">{{ character?.name }}</h3>
          <div class="flex flex-wrap gap-1">
            <div class="badge" title="Species" *ngIf="character?.species">
              {{ character?.species }}
            </div>
            <div class="badge" title="Gender" *ngIf="character?.gender">
              {{ character?.gender }}
            </div>
            <div class="badge" title="Type" *ngIf="character?.type">
              {{ character?.type }}
            </div>
            <div class="badge" title="Status" *ngIf="character?.status">
              {{ character?.status }}
            </div>
            <div
              class="badge"
              title="Location"
              *ngIf="character?.location?.name"
            >
              {{ character?.location?.name }}
            </div>
            <div class="badge" title="Origin" *ngIf="character?.origin?.name">
              {{ character?.origin?.name }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    class="border-t backdrop-blur-sm bg-background/95 z-40 sticky bottom-0 left-0 w-full"
  >
    <div class="container flex justify-between items-center h-16">
      <button
        (click)="previousPage()"
        [disabled]="currentPage === 1"
        class="btn btn-white"
      >
        Anterior
      </button>
      <div class="text-xs text-muted-foreground">
        Página <b>{{ currentPage }}</b> de <b>{{ totalPages }}</b>
      </div>
      <button
        (click)="nextPage()"
        [disabled]="currentPage === totalPages"
        class="btn btn-white"
      >
        Próximo
      </button>
    </div>
  </div>
</div>

<ng-template #loading>
  <p>Carregando personagens...</p>
</ng-template>
