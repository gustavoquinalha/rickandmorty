<div class="w-full min-h-[calc(100dvh-4rem)]">
  <div
    class="flex justify-center items-center fixed md:sticky top-[calc(100%-4rem)] md:top-0 left-0 z-50 border-t md:border-t-0 border-b-0 md:border-b w-full backdrop-blur-sm bg-background/95"
  >
    <div class="container flex justify-between items-center gap-2 h-16">
      <div class="flex items-center gap-2">
        <a routerLink="/" class="btn btn-border">
          <span class="text-lg leading-none">👈</span>
          <span class="hidden md:block">Back</span>
        </a>

        <span
          class="text-sm md:ml-2 truncate whitespace-nowrap block text-muted-foreground"
        >
          Character {{ characterId }}</span
        >
      </div>

      <div class="flex justify-between items-center gap-2">
        <button
          *ngIf="character"
          (click)="toggleFavorite($event, character.id)"
          class="btn bg-background/60 backdrop-blur-sm h-10 w-10 text-lg leading-none border"
        >
          {{ isFavorite(character.id) ? "❤️" : "🤍" }}
        </button>

        <button
          [ngClass]="{ disabled: characterId <= 1 }"
          (click)="goToPreviousCharacter()"
          class="btn btn-border w-10 md:w-auto px-0 md:px-3"
        >
          <span class="text-lg leading-none">👈</span>
          <span class="hidden md:block">Previous character</span>
        </button>

        <button
          [ngClass]="{ disabled: this.characterId >= this.maxCharacters }"
          (click)="goToNextCharacter()"
          class="btn btn-border w-10 md:w-auto px-0 md:px-3"
        >
          <span class="hidden md:block">Next character</span>
          <span class="text-lg leading-none">👉</span>
        </button>
      </div>
    </div>
  </div>

  <ng-container
    *ngIf="
      !loadingCharacter && !loadingLocation && !loadingEpisodes;
      else loading
    "
  >
    <div *ngIf="character; else empty" class="container py-8">
      <div class="max-w-2xl mx-auto flex flex-col gap-4">
        <app-card-character-detail [character]="character" />

        <app-card-location
          *ngIf="location"
          class="w-full"
          [location]="location"
        />

        <div
          *ngIf="episodes"
          class="group w-full relative border rounded-xl text-foreground transition-all p-6 flex flex-col gap-6 bg-input/50 overflow-hidden"
        >
          <h3
            class="font-semibold text-xl text-center md:text-left tracking-widest font-creepster flex items-center gap-2"
          >
            <span class="text-xl">📽️</span>
            <span>Episodes</span>
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 overflow-auto">
            <ng-container *ngFor="let episode of episodes">
              <app-card-episode [episode]="episode" />
            </ng-container>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<ng-template #empty>
  <app-empty-result
    [icons]="'👽😭💔'"
    [title]="'No character found!'"
    [subtitle]="'Please try searching again'"
    [back]="true"
  />
</ng-template>

<ng-template #loading>
  <app-loading />
</ng-template>
